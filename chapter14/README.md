## 14.1 テストコードを読みやすくする

```
テストコードを読みやすくするのは、テスト以外のコードを読みやすくするのと
同じくらい大切なことだ。テストコードは非公式なコードの説明文書と考えるプログラマもいる。
テストが読みやすければ、動作の理解は容易である
```

## 14.2 このテストのどこがダメ？

- コードサンプルのみなので割愛

## 14.3 テストを読みやすく

- 大切ではない詳細はユーザーから隠し、伝えるべき詳細を目立つように

- 今回の例における大切ではない部分
    - オブジェクトのセットアップ
	- 繰り返し登場するurl
	- doc[0]などの配列のindex情報
	
- 直し方
    - ヘルパー関数による煩雑な部分の切り出し
	
- 残課題
	- コードをコピペしなければ似たテストを作れない
	
### 最小のテストを作る

- 12章の技　コードに思いを込める　を使う
    - テストが何をするかを簡単な言葉で説明する
	- 繰り返し部分を,区切りでまとめて１行にしてみた。
	
### 独自のミニ言語を実装する

- ,をパースする関数を作って簡単になったという話

## 14.4 エラーメッセージを読みやすく

- assertの失敗がわかりづらい

### もっといいassert()をつかおう

- どの言語を使っていても役に立つライブラリやフレームワークがきっとある。

### 手作りのエラーメッセージ

- エラーメッセージは役に立つように
- エラーメッセージを印字する手づくりのアサートを作るのも良いかもしれない。（そうだろうか）

## 14.5 テストの適切な入力値を選択する

### 適切な入力値とは
- コードを完全にテストできる。
- 簡単によめるような単純なものである。
    - 例えばマイナス値
		
### 入力値を単純化する
- -999.87 => -1 にする。マイナスのテストをしたいだけだから。
    - テストには最も綺麗で単純な値を選びましょう

- ストレステストではその限りではないが、それは別でやればよい。

### １つの機能に複数のテスト

- テストしたい内容によって小さなテストを複数作るほうが、簡単で効果的で読みやすい

 
## 14.6 テストに名前を与える

- テストコードの名前はコメントだと思って適切な内容を与える事

## 14.7 このテストのどこがダメだったのか

- 重要なことがうもれている。ステートメントを短くしたい
- 簡単に追加できない。コピペしたくなる
- 失敗メッセージの意味がわからない
- 一度に違うテストをされていてわかりづらい。
- テストの入力値は単純ではない
- 入力値が不完全
- 極端な値を使っていない。
- 関数の名前に意味がない

## 14.8 テストに優しい開発

- テストしやすいコードには明確なインターフェースがある
    - 状態やセットアップがない
    - 検査するデータが隠されていない
    - あとでテストを書くつもりでコードを書くと、テストしやすいようにコードを設計できる

- テスト駆動開発

```
t-wadaさんに聞くといいと思います
```

- プログラムをクラスやメソッドに分割するのは疎結合にした方がテストしやすいからである。

### テストしづらいアンチパターン

 - グローバル変数を使っている。そのためテスト同士が干渉する
 - 外部コンポーネント依存。足場の設定がだるくてテストを書かなくなる
 - コードが非決定的な動作をする
 

### 良いテストって

 - 内部状態を持たない。クラスが小さい。
    - メソッドのテストにセットアップが不要。

 - クラスや関数が１つのことをしている
    - 完全にテストするためのテストケースが少なくて済む。
	 
 - 高度に疎結合である
    - 各クラスのテストを独立できる

 - 単純でインターフェースが明快
    - 明確なテストができる。
	 
## 14.9 やりすぎ

 - テストのしやすさのために本物のコードにゴミを入れない事
 - カバレッジの為にコストの高いテストをしない方がいい
 
